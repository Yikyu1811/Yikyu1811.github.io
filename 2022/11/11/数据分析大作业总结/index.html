<!DOCTYPE html><html lang="zn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>数据分析大作业总结 | yikyuの杂货铺</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config = {"hostname":"http://example.com","root":"/","preload":false,"path":""}</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.2.0"></head><body style="background-image:url(/img/001.jpg);"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>数据分析大作业总结</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2022-11-11T14:19:31.000Z" id="date"> 2022-11-11</time></div></span><br><span>Last Update: <div class="control"><time datetime="2022-11-11T14:56:53.329Z" id="updated"> 2022-11-11</time></div></span></div></div><hr><div id="post-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>主要是记录一下自己在大作业期间学习pandas库和数据图表的问题和解决方式</p>
<h1 id="一些分析"><a href="#一些分析" class="headerlink" title="一些分析"></a>一些分析</h1><p>数据分析的要点主要有：批量读取文件，数据的合并，数据的分析和输出</p>
<h2 id="批量读取文件和数据的合并"><a href="#批量读取文件和数据的合并" class="headerlink" title="批量读取文件和数据的合并"></a>批量读取文件和数据的合并</h2><p>首先获得文件路径和文件列表，依次将其组合后再进行合并操作，之后就可以使用循环读取文件数据了。<br>其中要解决文件表头统一的问题，因为合并时不能对空表进行合并所以要先对第一个文件进行读取之后从第二个文件开始循环。<br><label style="color:red">注意：pandas库在处理大量数据时，一旦超过设置显示上限会出现缩略表格，这个缩略表格会被直接存入默认的list列表中，因此要全程使用pandas库的表格进行操作，不然会出现大量的数据丢失。</label></p>
<figure class="highlight open plaintext"><span class="code-header">    <span class="code-title">      <div class="code-icon"></div>TEXT 共 12 行</span>      <span class="code-header-tail">        <button class="code-copy"></button>        <span class="code-space">展开</span></span></span></span>    <div class="code-box"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">import pandas as pd<br>import os<br>path=&#x27;babynames/&#x27;<br>filelist=os.listdir(path)<br>mian=[]<br>for i in filelist:<br>    filepath=os.path.join(path,i)<br>    data=pd.DataFrame(pd.read_csv(filepath))<br>    mian.append(data)<br>dfall=pd.DataFrame(mian)<br>print(dfall)<br>dfall.to_csv(&#x27;a.txt&#x27;)<br></code></pre></td></tr></table></div></figure>
<p>输出结果：</p>
<img src="/2022/11/11/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%A4%A7%E4%BD%9C%E4%B8%9A%E6%80%BB%E7%BB%93/%E9%94%99%E8%AF%AF%E8%BE%93%E5%87%BA.png" class="" title="asd">
<p><label style="color:red">循环错误，不能使用int i进行计数循环例如：</label></p>
<figure class="highlight open plaintext"><span class="code-header">    <span class="code-title">      <div class="code-icon"></div>TEXT 共 1 行</span>      <span class="code-header-tail">        <button class="code-copy"></button>        <span class="code-space">展开</span></span></span></span>    <div class="code-box"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">for i in (1,len(filelist)-1):<br></code></pre></td></tr></table></div></figure>
<p><label style="color:red">会出数据大面积丢失，只会保留第一次和最后一次循环的数据<br>&#x2F;&#x2F;暂时还没有排查到原因，可能是和for循环中的自动计数有关：</label><br>错误实例：</p>
<figure class="highlight open plaintext"><span class="code-header">    <span class="code-title">      <div class="code-icon"></div>TEXT 共 13 行</span>      <span class="code-header-tail">        <button class="code-copy"></button>        <span class="code-space">展开</span></span></span></span>    <div class="code-box"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># %%<br>import pandas as pd<br>import os<br>path=&#x27;babynames1/&#x27;<br>filelist=os.listdir(path)<br>t = [&#x27;姓名&#x27;, &#x27;性别&#x27;, &#x27;人数&#x27;]<br>mian=pd.DataFrame(pd.read_csv(&#x27;babynames/yob1880.txt&#x27;,index_col=0,header=None,names=t))<br>for i in (1,len(filelist)-1):<br>    filepath=os.path.join(path,filelist[i])<br>    data=pd.DataFrame(pd.read_csv(filepath,index_col=0,header=None,names=t))<br>    mian=pd.concat([mian,data])<br># %%<br>mian<br></code></pre></td></tr></table></div></figure>
<img src="/2022/11/11/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%A4%A7%E4%BD%9C%E4%B8%9A%E6%80%BB%E7%BB%93/%E5%9B%BE%E7%89%872.png" class="" title="asd"> 
<img src="/2022/11/11/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%A4%A7%E4%BD%9C%E4%B8%9A%E6%80%BB%E7%BB%93/%E5%9B%BE%E7%89%873.png" class="" title="asd">
<p>实际数据集</p>
<img src="/2022/11/11/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%A4%A7%E4%BD%9C%E4%B8%9A%E6%80%BB%E7%BB%93/%E5%9B%BE%E7%89%874.png" class="" title="asd">
<p>错误验证：<br>当文件只保留第一个第二个和最后一个的时候，结果和错误代码的输出一致</p>
<img src="/2022/11/11/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%A4%A7%E4%BD%9C%E4%B8%9A%E6%80%BB%E7%BB%93/%E5%9B%BE%E7%89%875.png" class="" title="asd"> 
<img src="/2022/11/11/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%A4%A7%E4%BD%9C%E4%B8%9A%E6%80%BB%E7%BB%93/%E5%9B%BE%E7%89%876.png" class="" title="asd">
<p>最后展示正确的代码：</p>
<figure class="highlight open plaintext"><span class="code-header">    <span class="code-title">      <div class="code-icon"></div>TEXT 共 15 行</span>      <span class="code-header-tail">        <button class="code-copy"></button>        <span class="code-space">展开</span></span></span></span>    <div class="code-box"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#数据合并<br>import pandas as pd<br>import os<br>path=&#x27;babynames/&#x27;#设置默认文件夹路径<br>filelist=os.listdir(path)#读取文件列表<br>t = [&#x27;姓名&#x27;, &#x27;性别&#x27;, &#x27;人数&#x27;]#设置表头以便后续文件数据合并<br>mian=pd.DataFrame(pd.read_csv(os.path.join(path,filelist[0]),index_col=0,header=None,names=t))#读取文件列表中的第一个文件<br>#其中index_col=0为取消索引,header=None为取消表头,names=t为添加表头<br>for i in filelist[1:]:#从第二个文件开始依次读取<br>    filepath=os.path.join(path,i)#将文件夹路径和文件名依次读取合并<br>    data=pd.DataFrame(pd.read_csv(filepath,index_col=0,header=None,names=t))#读取文件<br>    mian=pd.concat([mian,data])#将读取文件依次和总表合并<br>mian.to_csv(&#x27;数据总和.txt&#x27;)<br>print(&#x27;数据合并完成&#x27;)<br><br></code></pre></td></tr></table></div></figure><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2022/11/06/blog-log-2022-11-06/">blog-log-2022-11-06 Prev →</a></div></div></div><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="/img/logo.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/Yikyu1811">Yikyu</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">一些分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8C%E6%95%B0%E6%8D%AE%E7%9A%84%E5%90%88%E5%B9%B6"><span class="toc-number">2.1.</span> <span class="toc-text">批量读取文件和数据的合并</span></a></li></ol></li></ol></div></div></div><footer><text>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></text><text> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></text><wbr><text>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></text></footer></aside></main><canvas id="canvas-dust"></canvas><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: ''
 , appKey: '' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>